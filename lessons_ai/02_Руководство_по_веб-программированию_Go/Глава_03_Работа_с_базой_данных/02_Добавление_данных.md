# –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö

## üí° –ö–ª—é—á–µ–≤—ã–µ –∏–¥–µ–∏

1. **db.Exec** ‚Äî –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ INSERT, UPDATE, DELETE
2. **FormValue** ‚Äî –ø–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∏–∑ —Ñ–æ—Ä–º—ã
3. **–ü–ª–µ–π—Å—Ö–æ–ª–¥–µ—Ä—ã** ‚Äî –∑–∞—â–∏—Ç–∞ –æ—Ç SQL –∏–Ω—ä–µ–∫—Ü–∏–π
4. **Result.LastInsertId** ‚Äî ID –¥–æ–±–∞–≤–ª–µ–Ω–Ω–æ–π –∑–∞–ø–∏—Å–∏
5. **Redirect** ‚Äî –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ—Å–ª–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è

---

## üìã –°–∏–Ω—Ç–∞–∫—Å–∏—Å

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∑–∞–ø–∏—Å–∏

```go
result, err := db.Exec("INSERT INTO table (col1, col2) VALUES (?, ?)", val1, val2)

// –ü–æ–ª—É—á–µ–Ω–∏–µ ID –Ω–æ–≤–æ–π –∑–∞–ø–∏—Å–∏
id, err := result.LastInsertId()

// –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞—Ç—Ä–æ–Ω—É—Ç—ã—Ö —Å—Ç—Ä–æ–∫
affected, err := result.RowsAffected()
```

### –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö —Ñ–æ—Ä–º—ã

```go
name := r.FormValue("name")
price := r.FormValue("price")
```

---

## üíª –ü—Ä–∏–º–µ—Ä—ã –∫–æ–¥–∞

### –§–æ—Ä–º–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è (HTML)

**templates/create.html:**
```html
<!DOCTYPE html>
<html>
<head>
    <title>Add Product</title>
    <style>
        form { max-width: 400px; }
        label { display: block; margin-top: 10px; }
        input { width: 100%; padding: 8px; margin-top: 5px; }
        button { margin-top: 15px; padding: 10px 20px; }
        .error { color: red; }
    </style>
</head>
<body>
    <h1>Add New Product</h1>
    
    {{ if .Error }}
    <p class="error">{{ .Error }}</p>
    {{ end }}
    
    <form action="/create" method="POST">
        <label>Name:
            <input type="text" name="name" required>
        </label>
        
        <label>Price:
            <input type="number" name="price" required min="0">
        </label>
        
        <button type="submit">Add Product</button>
    </form>
    
    <p><a href="/">Back to list</a></p>
</body>
</html>
```

### –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è

```go
package main

import (
    "database/sql"
    "html/template"
    "net/http"
    "strconv"
    
    "github.com/gorilla/mux"
    _ "github.com/go-sql-driver/mysql"
)

type Product struct {
    ID    int
    Name  string
    Price int
}

var database *sql.DB

func main() {
    var err error
    database, err = sql.Open("mysql", "root:password@tcp(localhost:3306)/productdb")
    if err != nil {
        panic(err)
    }
    defer database.Close()
    
    router := mux.NewRouter()
    router.HandleFunc("/", listHandler).Methods("GET")
    router.HandleFunc("/create", createHandler).Methods("GET", "POST")
    
    http.ListenAndServe(":8080", router)
}

func createHandler(w http.ResponseWriter, r *http.Request) {
    // GET ‚Äî –ø–æ–∫–∞–∑–∞—Ç—å —Ñ–æ—Ä–º—É
    if r.Method == http.MethodGet {
        tmpl := template.Must(template.ParseFiles("templates/create.html"))
        tmpl.Execute(w, nil)
        return
    }
    
    // POST ‚Äî –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å —Ñ–æ—Ä–º—É
    name := r.FormValue("name")
    priceStr := r.FormValue("price")
    
    // –í–∞–ª–∏–¥–∞—Ü–∏—è
    if name == "" {
        showError(w, "Name is required")
        return
    }
    
    price, err := strconv.Atoi(priceStr)
    if err != nil || price < 0 {
        showError(w, "Invalid price")
        return
    }
    
    // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤ –ë–î
    result, err := database.Exec(
        "INSERT INTO products (name, price) VALUES (?, ?)",
        name, price,
    )
    if err != nil {
        showError(w, "Database error: "+err.Error())
        return
    }
    
    // –ü–æ–ª—É—á–∞–µ–º ID –Ω–æ–≤–æ–π –∑–∞–ø–∏—Å–∏ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
    id, _ := result.LastInsertId()
    _ = id  // –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è —Ä–µ–¥–∏—Ä–µ–∫—Ç–∞ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É —Ç–æ–≤–∞—Ä–∞
    
    // –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è–µ–º –Ω–∞ —Å–ø–∏—Å–æ–∫
    http.Redirect(w, r, "/", http.StatusSeeOther)
}

func showError(w http.ResponseWriter, message string) {
    tmpl := template.Must(template.ParseFiles("templates/create.html"))
    tmpl.Execute(w, map[string]string{"Error": message})
}

func listHandler(w http.ResponseWriter, r *http.Request) {
    rows, _ := database.Query("SELECT id, name, price FROM products")
    defer rows.Close()
    
    var products []Product
    for rows.Next() {
        var p Product
        rows.Scan(&p.ID, &p.Name, &p.Price)
        products = append(products, p)
    }
    
    tmpl := template.Must(template.ParseFiles("templates/list.html"))
    tmpl.Execute(w, products)
}
```

### –°–ø–∏—Å–æ–∫ —Å –∫–Ω–æ–ø–∫–æ–π –¥–æ–±–∞–≤–ª–µ–Ω–∏—è

**templates/list.html:**
```html
<!DOCTYPE html>
<html>
<head>
    <title>Products</title>
    <style>
        table { border-collapse: collapse; width: 100%; max-width: 600px; }
        th, td { border: 1px solid #ddd; padding: 8px; }
        th { background-color: #4CAF50; color: white; }
        .actions { margin-bottom: 20px; }
        .btn { padding: 10px 20px; background: #4CAF50; color: white; text-decoration: none; }
    </style>
</head>
<body>
    <h1>Products</h1>
    
    <div class="actions">
        <a href="/create" class="btn">+ Add Product</a>
    </div>
    
    <table>
        <tr>
            <th>ID</th>
            <th>Name</th>
            <th>Price</th>
        </tr>
        {{ range . }}
        <tr>
            <td>{{ .ID }}</td>
            <td>{{ .Name }}</td>
            <td>${{ .Price }}</td>
        </tr>
        {{ else }}
        <tr>
            <td colspan="3">No products yet</td>
        </tr>
        {{ end }}
    </table>
</body>
</html>
```

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Å –≤–æ–∑–≤—Ä–∞—Ç–æ–º ID

```go
func createAndGetID(name string, price int) (int64, error) {
    result, err := database.Exec(
        "INSERT INTO products (name, price) VALUES (?, ?)",
        name, price,
    )
    if err != nil {
        return 0, err
    }
    
    return result.LastInsertId()
}

func createHandler(w http.ResponseWriter, r *http.Request) {
    if r.Method == http.MethodPost {
        name := r.FormValue("name")
        price, _ := strconv.Atoi(r.FormValue("price"))
        
        id, err := createAndGetID(name, price)
        if err != nil {
            http.Error(w, err.Error(), 500)
            return
        }
        
        // –†–µ–¥–∏—Ä–µ–∫—Ç –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É –Ω–æ–≤–æ–≥–æ —Ç–æ–≤–∞—Ä–∞
        http.Redirect(w, r, "/product/"+strconv.FormatInt(id, 10), http.StatusSeeOther)
        return
    }
    
    // GET ‚Äî –ø–æ–∫–∞–∑–∞—Ç—å —Ñ–æ—Ä–º—É
    tmpl := template.Must(template.ParseFiles("templates/create.html"))
    tmpl.Execute(w, nil)
}
```

### –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö

```go
type ProductForm struct {
    Name   string
    Price  int
    Errors map[string]string
}

func (f *ProductForm) Validate() bool {
    f.Errors = make(map[string]string)
    
    if strings.TrimSpace(f.Name) == "" {
        f.Errors["name"] = "Name is required"
    } else if len(f.Name) > 100 {
        f.Errors["name"] = "Name is too long (max 100 characters)"
    }
    
    if f.Price < 0 {
        f.Errors["price"] = "Price cannot be negative"
    } else if f.Price > 1000000 {
        f.Errors["price"] = "Price is too high"
    }
    
    return len(f.Errors) == 0
}

func createHandler(w http.ResponseWriter, r *http.Request) {
    if r.Method == http.MethodPost {
        price, _ := strconv.Atoi(r.FormValue("price"))
        
        form := ProductForm{
            Name:  r.FormValue("name"),
            Price: price,
        }
        
        if !form.Validate() {
            tmpl := template.Must(template.ParseFiles("templates/create.html"))
            tmpl.Execute(w, form)
            return
        }
        
        database.Exec(
            "INSERT INTO products (name, price) VALUES (?, ?)",
            form.Name, form.Price,
        )
        
        http.Redirect(w, r, "/", http.StatusSeeOther)
        return
    }
    
    tmpl := template.Must(template.ParseFiles("templates/create.html"))
    tmpl.Execute(w, ProductForm{})
}
```

**templates/create.html —Å –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π:**
```html
<!DOCTYPE html>
<html>
<head>
    <title>Add Product</title>
    <style>
        .error { color: red; font-size: 0.9em; }
        input.invalid { border-color: red; }
    </style>
</head>
<body>
    <h1>Add New Product</h1>
    
    <form action="/create" method="POST">
        <label>Name:
            <input type="text" name="name" value="{{ .Name }}"
                   {{ if .Errors.name }}class="invalid"{{ end }}>
            {{ if .Errors.name }}<span class="error">{{ .Errors.name }}</span>{{ end }}
        </label>
        
        <label>Price:
            <input type="number" name="price" value="{{ .Price }}"
                   {{ if .Errors.price }}class="invalid"{{ end }}>
            {{ if .Errors.price }}<span class="error">{{ .Errors.price }}</span>{{ end }}
        </label>
        
        <button type="submit">Add Product</button>
    </form>
</body>
</html>
```

---

## ‚ö†Ô∏è –ß–∞—Å—Ç—ã–µ –æ—à–∏–±–∫–∏

### 1. SQL –∏–Ω—ä–µ–∫—Ü–∏–∏

```go
// ‚ùå –ù–ò–ö–û–ì–î–ê —Ç–∞–∫ –Ω–µ –¥–µ–ª–∞–π—Ç–µ
query := "INSERT INTO products (name) VALUES ('" + name + "')"

// ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø–ª–µ–π—Å—Ö–æ–ª–¥–µ—Ä—ã
database.Exec("INSERT INTO products (name) VALUES (?)", name)
```

### 2. –ù–µ –ø—Ä–æ–≤–µ—Ä—è—é—Ç –æ—à–∏–±–∫–∏

```go
// ‚ùå –ò–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—à–∏–±–∫–∏
database.Exec("INSERT INTO products (name, price) VALUES (?, ?)", name, price)

// ‚úÖ –ü—Ä–æ–≤–µ—Ä—è–π—Ç–µ –æ—à–∏–±–∫—É
_, err := database.Exec("INSERT INTO products (name, price) VALUES (?, ?)", name, price)
if err != nil {
    // –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–∫–∏
}
```

### 3. –î–≤–æ–π–Ω–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞ —Ñ–æ—Ä–º—ã

```go
// ‚ùå –ü–æ—Å–ª–µ POST –æ—Å—Ç–∞—ë–º—Å—è –Ω–∞ —Ç–æ–π –∂–µ —Å—Ç—Ä–∞–Ω–∏—Ü–µ
if r.Method == http.MethodPost {
    database.Exec(...)
    fmt.Fprint(w, "Added!")  // Refresh = –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ
}

// ‚úÖ –†–µ–¥–∏—Ä–µ–∫—Ç –ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è
if r.Method == http.MethodPost {
    database.Exec(...)
    http.Redirect(w, r, "/", http.StatusSeeOther)
}
```

---

## üìù –ü—Ä–∞–∫—Ç–∏–∫–∞

### –ó–∞–¥–∞—á–∞ 1: User registration
–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.

### –ó–∞–¥–∞—á–∞ 2: Article creation
–°–æ–∑–¥–∞–Ω–∏–µ —Å—Ç–∞—Ç–µ–π –±–ª–æ–≥–∞.

### –ó–∞–¥–∞—á–∞ 3: Category management
CRUD –¥–ª—è –∫–∞—Ç–µ–≥–æ—Ä–∏–π.

### –ó–∞–¥–∞—á–∞ 4: Order creation
–°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–∫–∞–∑–∞ –∏–∑ –∫–æ—Ä–∑–∏–Ω—ã.

### –ó–∞–¥–∞—á–∞ 5: File upload + DB
–ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–∞ —Å –∑–∞–ø–∏—Å—å—é –≤ –ë–î.

### –ó–∞–¥–∞—á–∞ 6: Bulk insert
–ú–∞—Å—Å–æ–≤–æ–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –∑–∞–ø–∏—Å–µ–π.

### –ó–∞–¥–∞—á–∞ 7: Unique validation
–ü—Ä–æ–≤–µ—Ä–∫–∞ —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç–∏ (email).

### –ó–∞–¥–∞—á–∞ 8: Related data
–î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Å–≤—è–∑–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö.
