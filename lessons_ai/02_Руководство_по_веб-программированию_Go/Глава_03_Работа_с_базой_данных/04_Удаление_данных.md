# –£–¥–∞–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö

## üí° –ö–ª—é—á–µ–≤—ã–µ –∏–¥–µ–∏

1. **db.Exec DELETE** ‚Äî —É–¥–∞–ª–µ–Ω–∏–µ –∑–∞–ø–∏—Å–∏
2. **ID –∏–∑ URL** ‚Äî –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è —É–¥–∞–ª—è–µ–º–æ–π –∑–∞–ø–∏—Å–∏
3. **–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ** ‚Äî –∑–∞—â–∏—Ç–∞ –æ—Ç —Å–ª—É—á–∞–π–Ω–æ–≥–æ —É–¥–∞–ª–µ–Ω–∏—è
4. **Soft Delete** ‚Äî –º—è–≥–∫–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ (—Ñ–ª–∞–≥)
5. **–ö–∞—Å–∫–∞–¥–Ω–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ** ‚Äî —Å–≤—è–∑–∞–Ω–Ω—ã–µ –∑–∞–ø–∏—Å–∏

---

## üìã –°–∏–Ω—Ç–∞–∫—Å–∏—Å

### –£–¥–∞–ª–µ–Ω–∏–µ –∑–∞–ø–∏—Å–∏

```go
result, err := db.Exec("DELETE FROM products WHERE id = ?", id)

// –ü—Ä–æ–≤–µ—Ä–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è
affected, _ := result.RowsAffected()
if affected == 0 {
    // –ó–∞–ø–∏—Å—å –Ω–µ –Ω–∞–π–¥–µ–Ω–∞
}
```

### –ú—è–≥–∫–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ

```go
db.Exec("UPDATE products SET deleted_at = NOW() WHERE id = ?", id)
```

---

## üíª –ü—Ä–∏–º–µ—Ä—ã –∫–æ–¥–∞

### –ü—Ä–æ—Å—Ç–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ

```go
package main

import (
    "database/sql"
    "net/http"
    
    "github.com/gorilla/mux"
    _ "github.com/go-sql-driver/mysql"
)

var database *sql.DB

func main() {
    var err error
    database, err = sql.Open("mysql", "root:password@tcp(localhost:3306)/productdb")
    if err != nil {
        panic(err)
    }
    defer database.Close()
    
    router := mux.NewRouter()
    router.HandleFunc("/", listHandler).Methods("GET")
    router.HandleFunc("/delete/{id:[0-9]+}", deleteHandler).Methods("GET")
    
    http.ListenAndServe(":8080", router)
}

func deleteHandler(w http.ResponseWriter, r *http.Request) {
    vars := mux.Vars(r)
    id := vars["id"]
    
    result, err := database.Exec("DELETE FROM products WHERE id = ?", id)
    if err != nil {
        http.Error(w, err.Error(), 500)
        return
    }
    
    affected, _ := result.RowsAffected()
    if affected == 0 {
        http.NotFound(w, r)
        return
    }
    
    http.Redirect(w, r, "/", http.StatusSeeOther)
}
```

### –°–ø–∏—Å–æ–∫ —Å –∫–Ω–æ–ø–∫–∞–º–∏ —É–¥–∞–ª–µ–Ω–∏—è

**templates/list.html:**
```html
<!DOCTYPE html>
<html>
<head>
    <title>Products</title>
    <style>
        table { border-collapse: collapse; width: 100%; max-width: 700px; }
        th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
        th { background-color: #4CAF50; color: white; }
        .btn { padding: 5px 10px; text-decoration: none; color: white; border-radius: 3px; display: inline-block; }
        .btn-edit { background: #2196F3; }
        .btn-delete { background: #f44336; }
    </style>
</head>
<body>
    <h1>Products</h1>
    
    <p><a href="/create" class="btn" style="background:#4CAF50;">+ Add Product</a></p>
    
    <table>
        <tr>
            <th>ID</th>
            <th>Name</th>
            <th>Price</th>
            <th>Actions</th>
        </tr>
        {{ range . }}
        <tr>
            <td>{{ .ID }}</td>
            <td>{{ .Name }}</td>
            <td>${{ .Price }}</td>
            <td>
                <a href="/edit/{{ .ID }}" class="btn btn-edit">Edit</a>
                <a href="/delete/{{ .ID }}" class="btn btn-delete" 
                   onclick="return confirm('Delete {{ .Name }}?')">Delete</a>
            </td>
        </tr>
        {{ end }}
    </table>
</body>
</html>
```

### –£–¥–∞–ª–µ–Ω–∏–µ —á–µ—Ä–µ–∑ POST (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

```go
// –ò—Å–ø–æ–ª—å–∑—É–µ–º POST –≤–º–µ—Å—Ç–æ GET –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö
router.HandleFunc("/delete/{id:[0-9]+}", deleteHandler).Methods("POST")
```

**HTML —Ñ–æ—Ä–º–∞ –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è:**
```html
<form action="/delete/{{ .ID }}" method="POST" style="display:inline;">
    <button type="submit" class="btn btn-delete" 
            onclick="return confirm('Delete {{ .Name }}?')">Delete</button>
</form>
```

### –°—Ç—Ä–∞–Ω–∏—Ü–∞ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è —É–¥–∞–ª–µ–Ω–∏—è

```go
func deleteHandler(w http.ResponseWriter, r *http.Request) {
    vars := mux.Vars(r)
    id := vars["id"]
    
    if r.Method == http.MethodGet {
        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å—Ç—Ä–∞–Ω–∏—Ü—É –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è
        var p Product
        err := database.QueryRow(
            "SELECT id, name, price FROM products WHERE id = ?", id,
        ).Scan(&p.ID, &p.Name, &p.Price)
        
        if err == sql.ErrNoRows {
            http.NotFound(w, r)
            return
        }
        
        tmpl := template.Must(template.ParseFiles("templates/confirm_delete.html"))
        tmpl.Execute(w, p)
        return
    }
    
    // POST ‚Äî –≤—ã–ø–æ–ª–Ω—è–µ–º —É–¥–∞–ª–µ–Ω–∏–µ
    database.Exec("DELETE FROM products WHERE id = ?", id)
    
    http.Redirect(w, r, "/", http.StatusSeeOther)
}
```

**templates/confirm_delete.html:**
```html
<!DOCTYPE html>
<html>
<head>
    <title>Confirm Delete</title>
    <style>
        .warning { background: #fff3cd; border: 1px solid #ffc107; padding: 20px; max-width: 400px; }
        .btn { padding: 10px 20px; text-decoration: none; color: white; border: none; cursor: pointer; }
        .btn-danger { background: #f44336; }
        .btn-secondary { background: #6c757d; }
    </style>
</head>
<body>
    <h1>Confirm Delete</h1>
    
    <div class="warning">
        <p>Are you sure you want to delete:</p>
        <p><strong>{{ .Name }}</strong> - ${{ .Price }}</p>
        
        <form action="/delete/{{ .ID }}" method="POST" style="display:inline;">
            <button type="submit" class="btn btn-danger">Yes, Delete</button>
        </form>
        <a href="/" class="btn btn-secondary">Cancel</a>
    </div>
</body>
</html>
```

### Soft Delete (–º—è–≥–∫–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ)

```go
// –¢–∞–±–ª–∏—Ü–∞ —Å –ø–æ–ª–µ–º deleted_at
/*
ALTER TABLE products ADD COLUMN deleted_at DATETIME NULL;
*/

func softDeleteHandler(w http.ResponseWriter, r *http.Request) {
    vars := mux.Vars(r)
    id := vars["id"]
    
    // –ü–æ–º–µ—á–∞–µ–º –∫–∞–∫ —É–¥–∞–ª—ë–Ω–Ω–æ–µ –≤–º–µ—Å—Ç–æ —Ä–µ–∞–ª—å–Ω–æ–≥–æ —É–¥–∞–ª–µ–Ω–∏—è
    _, err := database.Exec(
        "UPDATE products SET deleted_at = NOW() WHERE id = ? AND deleted_at IS NULL",
        id,
    )
    if err != nil {
        http.Error(w, err.Error(), 500)
        return
    }
    
    http.Redirect(w, r, "/", http.StatusSeeOther)
}

// –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–æ–ª—å–∫–æ –Ω–µ—É–¥–∞–ª—ë–Ω–Ω—ã—Ö –∑–∞–ø–∏—Å–µ–π
func listHandler(w http.ResponseWriter, r *http.Request) {
    rows, _ := database.Query(
        "SELECT id, name, price FROM products WHERE deleted_at IS NULL",
    )
    defer rows.Close()
    
    // ...
}

// –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ —É–¥–∞–ª—ë–Ω–Ω–æ–π –∑–∞–ø–∏—Å–∏
func restoreHandler(w http.ResponseWriter, r *http.Request) {
    vars := mux.Vars(r)
    id := vars["id"]
    
    database.Exec("UPDATE products SET deleted_at = NULL WHERE id = ?", id)
    
    http.Redirect(w, r, "/", http.StatusSeeOther)
}
```

### –ö–æ—Ä–∑–∏–Ω–∞ (—É–¥–∞–ª—ë–Ω–Ω—ã–µ –∑–∞–ø–∏—Å–∏)

```go
func trashHandler(w http.ResponseWriter, r *http.Request) {
    rows, _ := database.Query(
        "SELECT id, name, price, deleted_at FROM products WHERE deleted_at IS NOT NULL ORDER BY deleted_at DESC",
    )
    defer rows.Close()
    
    var products []Product
    for rows.Next() {
        var p Product
        rows.Scan(&p.ID, &p.Name, &p.Price, &p.DeletedAt)
        products = append(products, p)
    }
    
    tmpl := template.Must(template.ParseFiles("templates/trash.html"))
    tmpl.Execute(w, products)
}

// –û–∫–æ–Ω—á–∞—Ç–µ–ª—å–Ω–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ
func permanentDeleteHandler(w http.ResponseWriter, r *http.Request) {
    vars := mux.Vars(r)
    id := vars["id"]
    
    database.Exec("DELETE FROM products WHERE id = ? AND deleted_at IS NOT NULL", id)
    
    http.Redirect(w, r, "/trash", http.StatusSeeOther)
}

// –û—á–∏—Å—Ç–∫–∞ –∫–æ—Ä–∑–∏–Ω—ã
func emptyTrashHandler(w http.ResponseWriter, r *http.Request) {
    database.Exec("DELETE FROM products WHERE deleted_at IS NOT NULL")
    
    http.Redirect(w, r, "/trash", http.StatusSeeOther)
}
```

### –ú–∞—Å—Å–æ–≤–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ

```go
func bulkDeleteHandler(w http.ResponseWriter, r *http.Request) {
    r.ParseForm()
    ids := r.Form["ids[]"]  // <input type="checkbox" name="ids[]" value="1">
    
    if len(ids) == 0 {
        http.Redirect(w, r, "/", http.StatusSeeOther)
        return
    }
    
    // –°—Ç—Ä–æ–∏–º –∑–∞–ø—Ä–æ—Å —Å –ø–ª–µ–π—Å—Ö–æ–ª–¥–µ—Ä–∞–º–∏
    placeholders := ""
    args := make([]interface{}, len(ids))
    for i, id := range ids {
        if i > 0 {
            placeholders += ","
        }
        placeholders += "?"
        args[i] = id
    }
    
    query := "DELETE FROM products WHERE id IN (" + placeholders + ")"
    database.Exec(query, args...)
    
    http.Redirect(w, r, "/", http.StatusSeeOther)
}
```

**HTML –¥–ª—è –º–∞—Å—Å–æ–≤–æ–≥–æ —É–¥–∞–ª–µ–Ω–∏—è:**
```html
<form action="/bulk-delete" method="POST">
    <table>
        <tr>
            <th><input type="checkbox" id="selectAll"></th>
            <th>ID</th>
            <th>Name</th>
        </tr>
        {{ range . }}
        <tr>
            <td><input type="checkbox" name="ids[]" value="{{ .ID }}"></td>
            <td>{{ .ID }}</td>
            <td>{{ .Name }}</td>
        </tr>
        {{ end }}
    </table>
    <button type="submit" onclick="return confirm('Delete selected items?')">Delete Selected</button>
</form>

<script>
document.getElementById('selectAll').addEventListener('change', function() {
    document.querySelectorAll('input[name="ids[]"]').forEach(cb => cb.checked = this.checked);
});
</script>
```

---

## ‚ö†Ô∏è –ß–∞—Å—Ç—ã–µ –æ—à–∏–±–∫–∏

### 1. –£–¥–∞–ª–µ–Ω–∏–µ —á–µ—Ä–µ–∑ GET

```go
// ‚ùå –ü–æ–∏—Å–∫–æ–≤—ã–µ –±–æ—Ç—ã –º–æ–≥—É—Ç —É–¥–∞–ª–∏—Ç—å –¥–∞–Ω–Ω—ã–µ
router.HandleFunc("/delete/{id}", deleteHandler).Methods("GET")

// ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ POST –¥–ª—è –∏–∑–º–µ–Ω—è—é—â–∏—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
router.HandleFunc("/delete/{id}", deleteHandler).Methods("POST")
```

### 2. –ö–∞—Å–∫–∞–¥–Ω–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ –±–µ–∑ –ø—Ä–æ–≤–µ—Ä–∫–∏

```go
// ‚ùå –£–¥–∞–ª—è–µ–º –∫–∞—Ç–µ–≥–æ—Ä–∏—é, –∞ —Ç–æ–≤–∞—Ä—ã –æ—Å—Ç–∞—é—Ç—Å—è –±–µ–∑ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
database.Exec("DELETE FROM categories WHERE id = ?", id)

// ‚úÖ –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å–≤—è–∑–∞–Ω–Ω—ã–µ –∑–∞–ø–∏—Å–∏
var count int
database.QueryRow("SELECT COUNT(*) FROM products WHERE category_id = ?", id).Scan(&count)
if count > 0 {
    http.Error(w, "Cannot delete category with products", 400)
    return
}
```

### 3. –ù–µ—Ç –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è

```go
// ‚ùå –°—Ä–∞–∑—É —É–¥–∞–ª—è–µ–º
<a href="/delete/{{ .ID }}">Delete</a>

// ‚úÖ –°–ø—Ä–∞—à–∏–≤–∞–µ–º –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ
<a href="/delete/{{ .ID }}" onclick="return confirm('Are you sure?')">Delete</a>
```

---

## üìù –ü—Ä–∞–∫—Ç–∏–∫–∞

### –ó–∞–¥–∞—á–∞ 1: Soft delete
–†–µ–∞–ª–∏–∑–∞—Ü–∏—è –º—è–≥–∫–æ–≥–æ —É–¥–∞–ª–µ–Ω–∏—è.

### –ó–∞–¥–∞—á–∞ 2: Trash bin
–ö–æ—Ä–∑–∏–Ω–∞ —Å –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ–º.

### –ó–∞–¥–∞—á–∞ 3: Bulk delete
–ú–∞—Å—Å–æ–≤–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ.

### –ó–∞–¥–∞—á–∞ 4: Cascade delete
–ö–∞—Å–∫–∞–¥–Ω–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ —Å–≤—è–∑–µ–π.

### –ó–∞–¥–∞—á–∞ 5: Auto-cleanup
–ê–≤—Ç–æ—É–¥–∞–ª–µ–Ω–∏–µ —Å—Ç–∞—Ä—ã—Ö –∑–∞–ø–∏—Å–µ–π.

### –ó–∞–¥–∞—á–∞ 6: Audit log
–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —É–¥–∞–ª–µ–Ω–∏–π.

### –ó–∞–¥–∞—á–∞ 7: Undo delete
–û—Ç–º–µ–Ω–∞ —É–¥–∞–ª–µ–Ω–∏—è (—Å —Ç–∞–π–º–µ—Ä–æ–º).

### –ó–∞–¥–∞—á–∞ 8: Archive
–ê—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞–Ω–∏–µ –≤–º–µ—Å—Ç–æ —É–¥–∞–ª–µ–Ω–∏—è.
