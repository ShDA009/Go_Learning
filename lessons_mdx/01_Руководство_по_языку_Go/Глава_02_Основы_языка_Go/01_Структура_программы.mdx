# Структура программы

<Meta>
reading_time: 6
</Meta>

<Overview>
- Каждый файл Go **обязательно** принадлежит пакету (`package`)
- Главный пакет исполняемой программы называется `main`
- Точка входа — функция `main()` в пакете `main`
- Импорты (`import`) идут сразу после объявления пакета
- Инструкции разделяются переносом строки (точка с запятой не нужна)

### Структура файла Go

```
┌─────────────────────────────────────────┐
│  package main          ← 1. Пакет       │
├─────────────────────────────────────────┤
│  import "fmt"          ← 2. Импорты     │
├─────────────────────────────────────────┤
│  // константы, переменные, типы         │
│  var name = "Go"       ← 3. Объявления  │
│  const version = 1.22                   │
├─────────────────────────────────────────┤
│  func main() {         ← 4. Функции     │
│      fmt.Println(name)                  │
│  }                                      │
└─────────────────────────────────────────┘
```
</Overview>

<Theory>
### Почему порядок важен?

В Go элементы программы должны идти в определённом порядке:

1. **package** — всегда первая строка (после комментариев)
2. **import** — сразу после package
3. **Объявления** — константы, переменные, типы
4. **Функции** — в любом порядке между собой

Компилятор ожидает этот порядок. Если поставить import после функции — ошибка.

### Точка с запятой — где она?

В Go точки с запятой **не нужны** в конце строк. Компилятор автоматически вставляет их при компиляции. Это делает код чище:

```go
// Go — не нужны точки с запятой
x := 10
y := 20
fmt.Println(x + y)

// C/Java — нужны точки с запятой
// int x = 10;
// int y = 20;
```

**Важно:** из-за этого открывающая скобка `{` должна быть на той же строке:

```go
// ✅ Правильно
func main() {
    // код
}

// ❌ Ошибка! Компилятор вставит ; после main()
func main()
{
    // код
}
```

### Комментарии

Go поддерживает два вида комментариев:

```go
// Однострочный комментарий

/*
Многострочный
комментарий
*/
```

Комментарии игнорируются компилятором и служат для документирования кода.

### Пробелы и форматирование

Go имеет **официальный стиль форматирования**. Утилита `go fmt` автоматически форматирует код:

```bash
go fmt main.go
```

Это устраняет споры о стиле в команде — все пишут одинаково.

### Почему Go требует использовать импорты?

Если вы импортировали пакет, но не используете его — код не скомпилируется:

```go
import "fmt"
import "os"  // ошибка: imported and not used

func main() {
    fmt.Println("hello")
    // os не используется!
}
```

Это заставляет держать код чистым. Используйте `_` для игнорирования:

```go
import _ "os"  // импортировать, но не использовать напрямую
```
</Theory>

<Syntax>
### Объявление пакета
```go
package имя_пакета
```

### Импорт пакетов
```go
// Один пакет
import "fmt"

// Несколько пакетов
import (
    "fmt"
    "os"
    "strings"
)
```

### Функция main
```go
func main() {
    // код программы
}
```

### Однострочный комментарий
```go
// Это комментарий
```

### Многострочный комментарий
```go
/*
   Это многострочный
   комментарий
*/
```
</Syntax>

<Examples>


### Пример 1: Минимальная программа
```go
package main

func main() {
    // Пустая программа — но она работает!
}
```

### Пример 2: Hello World
```go
package main

import "fmt"

func main() {
    fmt.Println("Hello, World!")
}
```

### Пример 3: Несколько инструкций
```go
package main

import "fmt"

func main() {
    fmt.Println("Строка 1")
    fmt.Println("Строка 2")
    fmt.Println("Строка 3")
}
```

### Пример 4: Несколько импортов
```go
package main

import (
    "fmt"
    "time"
)

func main() {
    fmt.Println("Сейчас:", time.Now())
}
```

### Пример 5: С комментариями
```go
/*
    Программа приветствия
    Автор: Go Developer
*/
package main

import "fmt"  // пакет для ввода-вывода

// main — точка входа в программу
func main() {
    fmt.Println("Hello!")  // выводим приветствие
}
```

### Пример 6: Несколько инструкций в строке (не рекомендуется)
```go
package main

import "fmt"

func main() {
    // Можно, но не нужно — плохая читаемость
    fmt.Print("A"); fmt.Print("B"); fmt.Println("C")
}
```
</Examples>

<Pitfalls>
### 1. Забыли package main
```go
// ❌ Неправильно
import "fmt"

func main() {
    fmt.Println("Hello")
}
// Ошибка: expected 'package', found 'import'

// ✅ Правильно
package main

import "fmt"

func main() {
    fmt.Println("Hello")
}
```

### 2. Пакет не называется main для исполняемой программы
```go
// ❌ Неправильно — программа не запустится как исполняемый файл
package myapp

func main() {
    // ...
}
// Ошибка: go run: cannot run non-main package

// ✅ Правильно
package main

func main() {
    // ...
}
```

### 3. Неиспользуемый импорт
```go
// ❌ Неправильно — Go не разрешает неиспользуемые импорты
package main

import (
    "fmt"
    "os"  // imported and not used
)

func main() {
    fmt.Println("Hello")
}

// ✅ Правильно — удалите неиспользуемый импорт
package main

import "fmt"

func main() {
    fmt.Println("Hello")
}
```

### 4. Импорт после кода
```go
// ❌ Неправильно
package main

func main() {}

import "fmt"  // импорт должен быть до функций

// ✅ Правильно
package main

import "fmt"

func main() {}
```

### 5. Нет функции main
```go
// ❌ Неправильно
package main

import "fmt"

func hello() {
    fmt.Println("Hello")
}
// Ошибка: function main is undeclared in the main package

// ✅ Правильно
package main

import "fmt"

func main() {
    hello()
}

func hello() {
    fmt.Println("Hello")
}
```
</Pitfalls>

<Task id="1" points="5">
<Title>Задание 1: Пакет и функция main</Title>
<Prompt>
Создайте минимальную работающую программу Go с правильной структурой: объявление пакета, импорт и функция main.
</Prompt>
<Hints>
- Порядок важен: package → import → func
- Фигурная скобка `{` должна быть на той же строке, что и `func main()`
</Hints>
<StarterCode>
```go
// Добавьте объявление пакета

// Добавьте импорт

// Создайте функцию main
```
</StarterCode>
<ExpectedOutput>
Программа запущена успешно!
</ExpectedOutput>
</Task>

<Task id="2" points="10">
<Title>Задание 2: Группировка импортов</Title>
<Prompt>
Импортируйте три пакета (`fmt`, `strings`, `strconv`) используя группировку, и продемонстрируйте использование каждого.
</Prompt>
<Hints>
- `strings.ToUpper("hello")` → "HELLO"
- `strconv.Itoa(42)` преобразует число в строку
</Hints>
<StarterCode>
```go
package main

// Используйте группировку import (
//     "fmt"
//     ...
// )

func main() {
    // Используйте все три пакета
}
```
</StarterCode>
<ExpectedOutput>
HELLO
42
Привет
</ExpectedOutput>
</Task>

<Task id="3" points="10">
<Title>Задание 3: Однострочные и многострочные комментарии</Title>
<Prompt>
Создайте программу с обоими типами комментариев: однострочными (//) и многострочными (/* */). Комментарии должны описывать код.
</Prompt>
<Hints>
- `//` для коротких пояснений
- `/* */` для длинных описаний или временного отключения кода
</Hints>
<StarterCode>
```go
package main

import "fmt"

func main() {
    // Добавьте комментарии разных типов
    fmt.Println("Комментарии добавлены")
}
```
</StarterCode>
<ExpectedOutput>
Комментарии добавлены
</ExpectedOutput>
</Task>

<Task id="4" points="15">
<Title>Задание 4: Функция init()</Title>
<Prompt>
Создайте программу с функцией `init()`, которая выполняется автоматически перед `main()`. Продемонстрируйте порядок выполнения.
</Prompt>
<Hints>
- `init()` вызывается автоматически, не нужно вызывать явно
- В одном файле может быть несколько `init()`, но обычно используют одну
</Hints>
<StarterCode>
```go
package main

import "fmt"

// Создайте функцию init()

func main() {
    fmt.Println("[main] Программа запущена")
}
```
</StarterCode>
<ExpectedOutput>
[init] Инициализация...
[main] Программа запущена
</ExpectedOutput>
</Task>

<Task id="5" points="20">
<Title>Задание 5: Полная структура программы</Title>
<Prompt>
Создайте полноценную программу со всеми элементами структуры: комментарий-документация пакета, импорты, константы, функция init(), функция main().
</Prompt>
<Hints>
- Документирующий комментарий: `// Package main ...`
- Константы объявляются через `const`
</Hints>
<StarterCode>
```go
// Добавьте документацию пакета
package main

// Импорты

// Константы

// init и main
```
</StarterCode>
<ExpectedOutput>
Приложение: DemoApp v1.0
Инициализация завершена
Добро пожаловать!
</ExpectedOutput>
</Task>
