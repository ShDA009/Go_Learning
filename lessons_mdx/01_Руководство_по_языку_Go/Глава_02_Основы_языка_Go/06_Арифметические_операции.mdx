# Арифметические операции

<Meta>
reading_time: 11
</Meta>

<Overview>
- Go поддерживает стандартные арифметические операции: `+`, `-`, `*`, `/`, `%`
- **Деление целых чисел** отбрасывает дробную часть
- `%` (остаток от деления) работает **только с целыми числами**
- `++` и `--` — только **постфиксные** и только как **отдельные инструкции**
- Операции между **разными типами** требуют явного преобразования

### Таблица арифметических операций

| Операция | Символ | Пример | Результат |
|----------|--------|--------|-----------|
| Сложение | `+` | `5 + 3` | `8` |
| Вычитание | `-` | `5 - 3` | `2` |
| Умножение | `*` | `5 * 3` | `15` |
| Деление | `/` | `5 / 3` | `1` (для int) |
| Остаток | `%` | `5 % 3` | `2` |
| Инкремент | `++` | `x++` | `x = x + 1` |
| Декремент | `--` | `x--` | `x = x - 1` |
</Overview>

<Theory>
### Целочисленное деление

При делении **целых чисел** дробная часть **отбрасывается** (не округляется!):

```go
fmt.Println(7 / 2)   // 3 (не 3.5 и не 4)
fmt.Println(1 / 2)   // 0
fmt.Println(-7 / 2)  // -3
```

Если нужен точный результат — используйте float:
```go
fmt.Println(7.0 / 2.0)   // 3.5
fmt.Println(float64(7) / float64(2))  // 3.5
```

### Остаток от деления (%)

Оператор `%` возвращает остаток от деления:
```go
fmt.Println(7 % 2)   // 1 (7 = 2*3 + 1)
fmt.Println(10 % 3)  // 1 (10 = 3*3 + 1)
fmt.Println(8 % 4)   // 0 (делится нацело)
```

**Важно:** `%` работает только с целыми числами!

Практическое применение:
```go
// Проверка на чётность
if n % 2 == 0 {
    fmt.Println("Чётное")
}

// Циклический переход (0, 1, 2, 0, 1, 2, ...)
index = (index + 1) % 3
```

### Инкремент и декремент — особенности Go

В Go `++` и `--` — это **инструкции**, не выражения:

```go
x := 5
x++        // OK: x теперь 6

y := x++   // ОШИБКА! ++ не возвращает значение
z := ++x   // ОШИБКА! Нет префиксной формы
```

Сравните с C/Java, где `y = x++` допустимо.

### Почему Go ограничивает ++/--?

Это предотвращает код вроде:
```c
// C код — какой будет результат?
int a = 5;
int b = a++ + ++a;  // Неопределённое поведение!
```

В Go такой код невозможен, что делает программы предсказуемыми.

### Преобразование типов при арифметике

Go **не делает** неявного преобразования типов:

```go
var a int32 = 10
var b int64 = 20
var c = a + b  // ОШИБКА! Нельзя складывать int32 и int64
var c = int64(a) + b  // OK
```

Это предотвращает ошибки, связанные с переполнением и потерей точности.

### Переполнение

Если результат больше, чем может хранить тип — происходит переполнение:

```go
var x uint8 = 255
x++  // x = 0 (переполнение, без ошибки!)

var y int8 = 127
y++  // y = -128 (переполнение со знаком)
```

Go не проверяет переполнение автоматически — будьте осторожны!
</Theory>

<Syntax>
### Базовые операции
```go
a + b   // сложение
a - b   // вычитание
a * b   // умножение
a / b   // деление
a % b   // остаток от деления (только для целых)
```

### Инкремент и декремент
```go
x++     // x = x + 1 (постфиксный)
x--     // x = x - 1 (постфиксный)
```

### Унарный минус
```go
-x      // смена знака
```
</Syntax>

<Examples>
кода

### Пример 1: Базовые операции
```go
package main

import "fmt"

func main() {
    a := 10
    b := 3
    
    fmt.Printf("%d + %d = %d\n", a, b, a+b)   // 10 + 3 = 13
    fmt.Printf("%d - %d = %d\n", a, b, a-b)   // 10 - 3 = 7
    fmt.Printf("%d * %d = %d\n", a, b, a*b)   // 10 * 3 = 30
    fmt.Printf("%d / %d = %d\n", a, b, a/b)   // 10 / 3 = 3
    fmt.Printf("%d %% %d = %d\n", a, b, a%b)  // 10 % 3 = 1
}
```

### Пример 2: Деление целых vs дробных
```go
package main

import "fmt"

func main() {
    // Деление целых чисел — результат целый
    intA := 10
    intB := 3
    fmt.Printf("int: %d / %d = %d\n", intA, intB, intA/intB)  // 3
    
    // Деление дробных — результат дробный
    floatA := 10.0
    floatB := 3.0
    fmt.Printf("float: %.1f / %.1f = %.4f\n", floatA, floatB, floatA/floatB)  // 3.3333
    
    // Смешанное деление — нужно преобразование!
    result := float64(intA) / float64(intB)
    fmt.Printf("mixed: %d / %d = %.4f\n", intA, intB, result)  // 3.3333
}
```

### Пример 3: Остаток от деления
```go
package main

import "fmt"

func main() {
    // Проверка чётности
    for i := 0; i < 10; i++ {
        if i%2 == 0 {
            fmt.Printf("%d — чётное\n", i)
        } else {
            fmt.Printf("%d — нечётное\n", i)
        }
    }
    
    // Циклический индекс
    colors := []string{"red", "green", "blue"}
    for i := 0; i < 10; i++ {
        fmt.Printf("i=%d, color=%s\n", i, colors[i%len(colors)])
    }
}
```

### Пример 4: Инкремент и декремент
```go
package main

import "fmt"

func main() {
    x := 5
    
    x++
    fmt.Println("После x++:", x)  // 6
    
    x++
    fmt.Println("После x++:", x)  // 7
    
    x--
    fmt.Println("После x--:", x)  // 6
}
```

### Пример 5: Унарный минус
```go
package main

import "fmt"

func main() {
    a := 5
    b := -a     // унарный минус
    c := -(-a)  // двойное отрицание
    
    fmt.Println("a =", a)   // 5
    fmt.Println("b =", b)   // -5
    fmt.Println("c =", c)   // 5
    
    // Вычисление модуля (абсолютного значения)
    x := -10
    if x < 0 {
        x = -x
    }
    fmt.Println("|x| =", x)  // 10
}
```

### Пример 6: Порядок операций (приоритет)
```go
package main

import "fmt"

func main() {
    // Умножение/деление выполняются раньше сложения/вычитания
    a := 2 + 3 * 4      // 2 + 12 = 14
    b := (2 + 3) * 4    // 5 * 4 = 20
    
    fmt.Println("2 + 3 * 4 =", a)     // 14
    fmt.Println("(2 + 3) * 4 =", b)   // 20
    
    // Деление и остаток — одинаковый приоритет, слева направо
    c := 20 / 4 % 3     // 5 % 3 = 2
    d := 20 % 4 / 3     // 0 / 3 = 0
    
    fmt.Println("20 / 4 % 3 =", c)    // 2
    fmt.Println("20 % 4 / 3 =", d)    // 0
}
```

### Пример 7: Практические примеры
```go
package main

import "fmt"

func main() {
    // Перевод секунд в минуты и секунды
    totalSeconds := 185
    minutes := totalSeconds / 60
    seconds := totalSeconds % 60
    fmt.Printf("%d секунд = %d мин %d сек\n", totalSeconds, minutes, seconds)
    
    // Расчёт среднего
    sum := 85 + 90 + 78 + 92 + 88
    count := 5
    average := float64(sum) / float64(count)
    fmt.Printf("Средний балл: %.2f\n", average)
    
    // Расчёт скидки
    price := 1000.0
    discount := 15  // процентов
    finalPrice := price - price*float64(discount)/100
    fmt.Printf("Цена со скидкой %d%%: %.2f\n", discount, finalPrice)
}
```

### Пример 8: Переполнение (overflow)
```go
package main

import "fmt"

func main() {
    var a int8 = 127
    fmt.Println("int8 max:", a)
    
    // a++ вызовет переполнение!
    a++
    fmt.Println("После ++:", a)  // -128 (переполнение!)
    
    // Безопасная проверка
    var b int8 = 127
    if b < 127 {
        b++
    } else {
        fmt.Println("Нельзя увеличить — переполнение!")
    }
}
```
</Examples>

<Pitfalls>
### 1. Деление целых — потеря дробной части
```go
// ❌ Неправильно — ожидали 2.5
result := 5 / 2  // result = 2, а не 2.5!

// ✅ Правильно — используйте float
result := 5.0 / 2.0  // 2.5
// или преобразование
result := float64(5) / float64(2)  // 2.5
```

### 2. Остаток от деления с float
```go
// ❌ Неправильно — % не работает с float
var a, b float64 = 5.5, 2.0
result := a % b  // invalid operation

// ✅ Правильно — используйте math.Mod
import "math"
result := math.Mod(a, b)  // 1.5
```

### 3. Префиксный ++/--
```go
// ❌ Неправильно — в Go нет префиксного инкремента
x := 5
y := ++x  // syntax error

// ✅ Правильно — только постфиксный и отдельно
x := 5
x++
y := x
```

### 4. Инкремент как выражение
```go
// ❌ Неправильно — нельзя использовать в выражении
x := 5
y := x++ + 1  // syntax error

// ✅ Правильно — инкремент отдельно
x := 5
x++
y := x + 1
```

### 5. Операции с разными типами
```go
// ❌ Неправильно — разные типы
var a int = 10
var b int64 = 20
c := a + b  // invalid operation: mismatched types

// ✅ Правильно — явное преобразование
c := int64(a) + b  // OK
```

### 6. Деление на ноль
```go
// ❌ Деление целого на ноль — паника!
a := 10
b := 0
c := a / b  // panic: runtime error: integer divide by zero

// ✅ Проверяйте делитель
if b != 0 {
    c := a / b
}

// Примечание: для float — результат Inf или NaN
var f float64 = 10.0 / 0.0  // +Inf (не паника)
```
</Pitfalls>

<Task id="1" points="10">
<Title>Задание 1: Базовые арифметические операции</Title>
<Prompt>
Выполните все базовые арифметические операции (+, -, *, /, %) с двумя числами и выведите результаты.
</Prompt>
<Hints>
- Деление целых чисел отбрасывает дробную часть
- Оператор % возвращает остаток от деления
</Hints>
<StarterCode>
```go
package main

import "fmt"

func main() {
    a, b := 17, 5
    fmt.Printf("a = %d, b = %d\n", a, b)
    // Выведите результаты всех операций
}
```
</StarterCode>
<ExpectedOutput>
a = 17, b = 5
Сложение: 17 + 5 = 22
Вычитание: 17 - 5 = 12
Умножение: 17 * 5 = 85
Деление: 17 / 5 = 3
Остаток: 17 % 5 = 2
</ExpectedOutput>
</Task>

<Task id="2" points="10">
<Title>Задание 2: Инкремент и декремент</Title>
<Prompt>
Продемонстрируйте работу операторов инкремента (++) и декремента (--) на примере счётчика.
</Prompt>
<Hints>
- В Go ++ и -- только постфиксные (x++, не ++x)
- Это операторы, не выражения (нельзя y = x++)
</Hints>
<StarterCode>
```go
package main

import "fmt"

func main() {
    counter := 10
    fmt.Println("Начальное значение:", counter)
    // Примените ++ и -- с выводом
}
```
</StarterCode>
<ExpectedOutput>
Начальное значение: 10
После ++: 11
После ++: 12
После --: 11
После --: 10
</ExpectedOutput>
</Task>

<Task id="3" points="15">
<Title>Задание 3: Деление с вещественными числами</Title>
<Prompt>
Сравните целочисленное и вещественное деление. Покажите разницу результатов.
</Prompt>
<Hints>
- 7/3 — деление целых, результат 2
- 7.0/3.0 — деление float, результат 2.333...
</Hints>
<StarterCode>
```go
package main

import "fmt"

func main() {
    // Целочисленное деление
    // Вещественное деление
}
```
</StarterCode>
<ExpectedOutput>
Целочисленное деление: 7 / 3 = 2
Вещественное деление: 7.0 / 3.0 = 2.33
</ExpectedOutput>
</Task>

<Task id="4" points="15">
<Title>Задание 4: Приоритет операций</Title>
<Prompt>
Продемонстрируйте приоритет операций и использование скобок для изменения порядка вычислений.
</Prompt>
<Hints>
- Умножение и деление выполняются раньше сложения и вычитания
- Скобки имеют наивысший приоритет
</Hints>
<StarterCode>
```go
package main

import "fmt"

func main() {
    // Покажите приоритет операций
}
```
</StarterCode>
<ExpectedOutput>
Без скобок: 2 + 3 * 4 = 14
Со скобками: (2 + 3) * 4 = 20
Сложный пример: 10 - 6 / 2 = 7
Со скобками: (10 - 6) / 2 = 2
</ExpectedOutput>
</Task>

<Task id="5" points="15">
<Title>Задание 5: Калькулятор площади и периметра</Title>
<Prompt>
Создайте калькулятор, который вычисляет площадь и периметр прямоугольника по заданным сторонам.
</Prompt>
<Hints>
- Периметр прямоугольника: P = 2(a + b)
- Площадь прямоугольника: S = a × b
</Hints>
<StarterCode>
```go
package main

import "fmt"

func main() {
    width := 8
    height := 5
    // Вычислите и выведите периметр и площадь
}
```
</StarterCode>
<ExpectedOutput>
Прямоугольник: 8 x 5
Периметр = 2 * (8 + 5) = 26
Площадь = 8 * 5 = 40
</ExpectedOutput>
</Task>
